= Signal tracks for the UCSC genome browser

== Create bigwig files from mappings

Create a bash script called `run_bigwig.sh` with the following:

[source,bash]
----
#!/bin/bash -e

# load env
. ~/rnaseq/.rnaseqenv

# load module
module load BEDTools/2.21.0-goolf-1.4.10-no-OFED
module load KentUtils/308-goolf-1.4.10-no-OFED


# create bedgraph from mappings
genomeCoverageBed -split -bg -ibam alignments/mouse_cns_E18_rep1_Aligned.sortedByCoord.out.bam > alignments/mouse_cns_E18_rep1_bedGraph.bed
# generate bigwig from bedgraph
bedGraphToBigWig alignments/mouse_cns_E18_rep1_bedGraph.bed ~/rnaseq/refs/mouse_genome_mm9.fa.fai alignments/mouse_cns_E18_rep1.bw
----

Submit the job to the cluster:

[source,bash]
----
qsub -cwd -q RNAseq -N bigwig_rnaseq_course -e logs -o logs ./run_bigwig.sh
----

== Visualize your results in the UCSC genome browser

Add the gene expression track to the genome browser in bigWig format.
The bigWig files must be either uploaded or linked (if they are present somewhere online)

Go to the USCS genome browser web page:

{UCSC_genome_browser}[^]

On the main menu, click on btn:[Genomes].
Click on btn:[Add custom track].
Make sure the assembly information is as follows:

[source,html]
----
clade: Mammal, genome: Mouse, assembly: July 2007 (NCBI/mm9)
----

Paste the track specifications for each file in the box `Paste URLs or data`:

[source,track]
----
track name=mouse_cns_E14_rep1.bw type=bigWig visibility=2 autoScale=off maxHeightPixels=30 color=0,149,347 viewLimits=0:30 bigDataUrl=http://genome.crg.es/~epalumbo/rnaseq/2015nov/mouse_cns_E14_rep1_Aligned.sortedByCoord.out.bw
track name=mouse_cns_E14_rep2.bw type=bigWig visibility=2 autoScale=off maxHeightPixels=30 color=0,149,347 viewLimits=0:30 bigDataUrl=http://genome.crg.es/~epalumbo/rnaseq/2015nov/mouse_cns_E14_rep2_Aligned.sortedByCoord.out.bw
track name=mouse_cns_E18_rep1.bw type=bigWig visibility=2 autoScale=off maxHeightPixels=30 color=69,139,0 viewLimits=0:30 bigDataUrl=http://genome.crg.es/~epalumbo/rnaseq/2015nov/mouse_cns_E18_rep1_Aligned.sortedByCoord.out.bw
track name=mouse_cns_E18_rep2.bw type=bigWig visibility=2 autoScale=off maxHeightPixels=30 color=69,139,0 viewLimits=0:30 bigDataUrl=http://genome.crg.es/~epalumbo/rnaseq/2015nov/mouse_cns_E18_rep2_Aligned.sortedByCoord.out.bw
----

Click btn:[Submit]

Go to the genome browser to look at some genes and their RNA-seq signal
